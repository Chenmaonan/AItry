import{P as ye}from"./index.c77a1531.js";import{e as K,o,g as f,G as ee,bn as G,h as t,m as A,s as re,q as w,f as Y,b8 as al,bo as ol,w as n,k as $,j as s,N as W,O as Q,y as oe,b0 as sl,bb as Pe,W as X,t as il,bp as ul,u as l,V as j,Z as E,be as Ie,bf as Le,aX as Te,ab as Me,aW as dl,$ as rl,z as be,B as cl,bq as ml,n as se,C as V,D as ue,am as ge,br as je,bs as pl,an as fl,bt as vl,b3 as _l,bu as hl,b5 as gl,bm as yl,b6 as bl,a$ as Cl,F as de,a4 as wl,a5 as kl,a6 as El,E as Ne,v as Fl,a_ as Al,ad as We,ae as Ge,bv as Sl,ap as $l,bd as Ue,bc as Vl}from"./.pnpm.adeb4fcc.js";import{u as Dl,_ as Bl}from"./usePaging.8d363e02.js";import{b as le,_ as ce,a as zl,e as he,R as Rl,f as H,r as q,h as xl,u as Ul}from"./index.32787260.js";const Pl=K({props:{showClose:{type:Boolean,default:!0}},emits:["close"],setup(e,{emit:r}){return{handleClose:()=>{r("close")}}}});const Il={class:"del-wrap"};function Ll(e,r,b,m,h,y){const u=ce;return o(),f("div",Il,[ee(e.$slots,"default",{},void 0,!0),e.showClose?(o(),f("div",{key:0,class:"icon-close",onClick:r[0]||(r[0]=G((...d)=>e.handleClose&&e.handleClose(...d),["stop"]))},[t(u,{size:12,name:"el-icon-CloseBold"})])):A("",!0)])}const qe=le(Pl,[["render",Ll],["__scopeId","data-v-2a98aa67"]]),Tl=K({components:{},props:{type:{type:String,default:"image"},multiple:{type:Boolean,default:!0},limit:{type:Number,default:10},data:{type:Object,default:()=>({})},showProgress:{type:Boolean,default:!1}},emits:["change","error"],setup(e,{emit:r}){const b=zl(),m=re(),h=w(`${he.baseUrl}${he.urlPrefix}/common/upload/${e.type}`),y=Y(()=>({token:b.token,version:he.version})),u=w(!1),d=w([]),v=(_,D,g)=>{u.value=!0,d.value=al(g)},p=(_,D,g)=>{var x;g.every(P=>P.status=="success")&&((x=m.value)==null||x.clearFiles(),u.value=!1,r("change")),_.code==Rl.FAILED&&_.msg&&H.msgError(_.msg)},c=(_,D)=>{var g;H.msgError(`${D.name}\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25`),(g=m.value)==null||g.abort(D),u.value=!1,r("change"),r("error")},F=()=>{H.msgError(`\u8D85\u51FA\u4E0A\u4F20\u4E0A\u9650${e.limit}\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20`)},R=()=>{var _;(_=m.value)==null||_.clearFiles(),u.value=!1},M=Y(()=>{switch(e.type){case"image":return".jpj,.png,.gif,.jpeg,.ico,.bmp";case"video":return".wmv,.avi,.mov,.mp4,.flv,.rmvb";default:return"*"}});return{uploadRefs:m,action:h,headers:y,visible:u,fileList:d,getAccept:M,handleProgress:v,handleSuccess:p,handleError:c,handleExceed:F,handleClose:R}}}),Ml={class:"upload"},jl={class:"file-list p-4"},Nl={class:"flex-1"};function Wl(e,r,b,m,h,y){const u=sl,d=ol,v=Pe;return o(),f("div",Ml,[t(u,{ref:"uploadRefs",action:e.action,multiple:e.multiple,limit:e.limit,"show-file-list":!1,headers:e.headers,data:e.data,"on-progress":e.handleProgress,"on-success":e.handleSuccess,"on-exceed":e.handleExceed,"on-error":e.handleError,accept:e.getAccept},{default:n(()=>[ee(e.$slots,"default")]),_:3},8,["action","multiple","limit","headers","data","on-progress","on-success","on-exceed","on-error","accept"]),e.showProgress&&e.fileList.length?(o(),$(v,{key:0,modelValue:e.visible,"onUpdate:modelValue":r[0]||(r[0]=p=>e.visible=p),title:"\u4E0A\u4F20\u8FDB\u5EA6","close-on-click-modal":!1,width:"500px",modal:!1,onClose:e.handleClose},{default:n(()=>[s("div",jl,[(o(!0),f(W,null,Q(e.fileList,(p,c)=>(o(),f("div",{key:c,class:"mb-5"},[s("div",null,oe(p.name),1),s("div",Nl,[t(d,{percentage:parseInt(p.percentage)},null,8,["percentage"])])]))),128))])]),_:1},8,["modelValue","onClose"])):A("",!0)])}const Gl=le(Tl,[["render",Wl]]),ql={class:"popover-input__input mr-[10px] flex-1"},Yl={class:"popover-input__btns flex-none"},Kl=["onClick"],Zl=K({__name:"index",props:{value:{type:String},type:{type:String,default:"text"},width:{type:[Number,String],default:"300px"},placeholder:String,disabled:{type:Boolean,default:!1},options:{type:Array,default:()=>[]},size:{type:String,default:"default"},limit:{type:Number,default:200},showLimit:{type:Boolean,default:!1},teleported:{type:Boolean,default:!0}},emits:["confirm"],setup(e,{emit:r}){const b=e,m=w(!1),h=w(!1),y=w(),u=()=>{v(),r("confirm",y.value)},d=()=>{b.disabled||(m.value=!0)},v=()=>{m.value=!1};return X(()=>b.value,p=>{y.value=p},{immediate:!0}),il(document.documentElement,"click",()=>{h.value||v()}),(p,c)=>{const F=Ie,R=Le,M=Te,_=Me,D=ul;return o(),f("div",{onMouseenter:c[4]||(c[4]=g=>h.value=!0),onMouseleave:c[5]||(c[5]=g=>h.value=!1)},[t(D,{placement:"top",visible:l(m),"onUpdate:visible":c[3]||(c[3]=g=>j(m)?m.value=g:null),width:e.width,trigger:"contextmenu",class:"popover-input",teleported:e.teleported,persistent:!1,"popper-class":"!p-0"},{reference:n(()=>[s("div",{class:"inline",onClick:G(d,["stop"])},[ee(p.$slots,"default")],8,Kl)]),default:n(()=>[s("div",{class:"flex p-3",onClick:c[2]||(c[2]=G(()=>{},["stop"]))},[s("div",ql,[e.type=="select"?(o(),$(R,{key:0,class:"flex-1",size:e.size,modelValue:l(y),"onUpdate:modelValue":c[0]||(c[0]=g=>j(y)?y.value=g:null),teleported:e.teleported},{default:n(()=>[(o(!0),f(W,null,Q(e.options,g=>(o(),$(F,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:1},8,["size","modelValue","teleported"])):(o(),$(M,{key:1,modelValue:l(y),"onUpdate:modelValue":c[1]||(c[1]=g=>j(y)?y.value=g:null),modelModifiers:{trim:!0},maxlength:e.limit,"show-word-limit":e.showLimit,type:e.type,size:e.size,clearable:"",placeholder:e.placeholder},null,8,["modelValue","maxlength","show-word-limit","type","size","placeholder"]))]),s("div",Yl,[t(_,{link:"",onClick:v},{default:n(()=>[E("\u53D6\u6D88")]),_:1}),t(_,{type:"primary",size:e.size,onClick:u},{default:n(()=>[E("\u786E\u5B9A")]),_:1},8,["size"])])])]),_:3},8,["visible","width","teleported"])],32)}}}),Ol="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAACJElEQVRYR+2YMWsUURSFz3m7s+nskjUIQSutbMRi7WzUVjSadMHCbVLkByjmLygaCVYWRqMEUhkFS9Gg0cJfYCPZjYUQFbPs+I7c2R1Q2ZjZfRNYYS4MAzPv3vnmvDvL3kMA2Hl5/CjLI9ckf4ZwY3Zt15C+gfwIao3So0rt3XsJtPUk9M/cAW6y9ap2DIyfAjgCwANwGeoYiEFtk/5e5CvXeer1D2neATcGgiTZM4+t9RNLEKcBtAFEGeBsiRWzl7EoSXo+8rV9gWc/fDc1B1VSEoEnDpj0KTB33tS26DGaEezvZQZpRxmODyoT5+vwBwS3zeTcT4yjTdZNJEiPSykk1bjZX6HeD/WQJ1zUApgq2w+etcsniBuAVlH9vELOx6Yo1VywgkmTB4X1kEGGhyAtg/Ecq3NNqnknDwVTrNBaactEts88OHs5b8Bw/Tof4M+kr4WrwwhoL9n5uRPWhxWwsxPEl+EGNMacP5I8evCPGgVgqKSFgoWCoQqE5hc9WCgYqkBoftGDeSiYz1/+UJLe+foftvh2A2B1fwQIrapkaFoDcK4PVyH0qVnyU4fjGdW4NQ2WlgDE5hLkMoJmQdh9zW9Dk59K5lhtLjyE01TX/jDILP5MGEbvbFPOJroIXvc5PjvTBbx7GM4vAjjd9WdSc2g/IPaqaTv5Aq58haP1TSb2Au20GGErvgTxIqiTAA7tVSnn+2Z9vAXdCsa4bD6Nsf0C/gYA5PMzcW0AAAAASUVORK5CYII=";function Ql(e){return q.post({url:"/common/album/cateAdd",params:e})}function Xl(e){return q.post({url:"/common/album/cateRename",params:e})}function Jl(e){return q.post({url:"/common/album/cateDel",params:e})}function Hl(e){return q.get({url:"/common/album/cateList",params:e})}function et(e){return q.get({url:"/common/album/albumList",params:e})}function lt(e){return q.post({url:"/common/album/albumDel",params:e})}function tt(e){return q.post({url:"/common/album/albumMove",params:e})}function nt(e){return q.post({url:"/common/album/albumRename",params:e})}function at(e){const r=re(),b=w([]),m=w(""),h=async()=>{const p=await Hl({type:e}),c=[];b.value=p,b.value.unshift(...c),setTimeout(()=>{var F;(F=r.value)==null||F.setCurrentKey(m.value)},0)};return{treeRef:r,cateId:m,cateLists:b,handleAddCate:async p=>{await Ql({type:e,name:p,pid:0}),h()},handleEditCate:async(p,c)=>{await Xl({id:c,name:p}),h()},handleDeleteCate:async p=>{await H.confirm("\u786E\u5B9A\u8981\u5220\u9664\uFF1F"),await Jl({id:p}),m.value="",h()},getCateLists:h,handleCatSelect:p=>{m.value=p.id}}}function ot(e,r,b,m){const h=re(),y=w("normal"),u=w(0),d=w([]),v=w(!1),p=w(!1),c=dl({name:"",type:r,cid:e}),{pager:F,getLists:R,resetPage:M}=Dl({fetchFun:et,params:c,firstLoading:!0,size:m}),_=()=>{R()},D=()=>{M()},g=i=>!!d.value.find(C=>C.id==i),Z=async i=>{await H.confirm("\u786E\u8BA4\u5220\u9664\u540E\uFF0C\u672C\u5730\u6216\u4E91\u5B58\u50A8\u6587\u4EF6\u4E5F\u5C06\u540C\u6B65\u5220\u9664\uFF0C\u5982\u6587\u4EF6\u5DF2\u88AB\u4F7F\u7528\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF01");const C=i||d.value.map(N=>N.id);await lt({ids:C}),_(),S()},x=async()=>{const i=d.value.map(C=>C.id);await tt({ids:i,cid:u.value}),u.value=0,_(),S()},P=i=>{const C=d.value.findIndex(N=>N.id==i.id);if(C!=-1){d.value.splice(C,1);return}if(d.value.length==b.value){if(b.value==1){d.value=[],d.value.push(i);return}rl.warning("\u5DF2\u8FBE\u5230\u9009\u62E9\u4E0A\u9650");return}d.value.push(i)},S=()=>{d.value=[]};return{listShowType:y,tableRef:h,moveId:u,pager:F,fileParams:c,select:d,isCheckAll:v,isIndeterminate:p,getFileList:_,refresh:D,batchFileDelete:Z,batchFileMove:x,selectFile:P,isSelect:g,clearSelect:S,cancelSelete:i=>{d.value=d.value.filter(C=>C.id!=i)},selectAll:i=>{var C;if(p.value=!1,(C=h.value)==null||C.toggleAllSelection(),i){d.value=[...F.lists];return}S()},handleFileRename:async(i,C)=>{await nt({id:C,name:i}),_()}}}const st=K({props:{uri:{type:String},fileSize:{type:String,default:"100px"},type:{type:String,default:"image"}},emits:["close"]});const it=["src"],ut={key:2,class:"absolute left-1/2 top-1/2 translate-x-[-50%] translate-y-[-50%] rounded-full w-5 h-5 flex justify-center items-center bg-[rgba(0,0,0,0.3)]"};function dt(e,r,b,m,h,y){const u=cl,d=ce;return o(),f("div",null,[s("div",{class:"file-item relative",style:be({height:e.fileSize,width:e.fileSize})},[e.type=="image"?(o(),$(u,{key:0,class:"image",fit:"contain",src:e.uri},null,8,["src"])):e.type=="video"?(o(),f("video",{key:1,class:"video",src:e.uri},null,8,it)):A("",!0),e.type=="video"?(o(),f("div",ut,[t(d,{name:"el-icon-CaretRight",size:18,color:"#fff"})])):A("",!0),ee(e.$slots,"default",{},void 0,!0)],4)])}const ie=le(st,[["render",dt],["__scopeId","data-v-ec4ebd66"]]),rt={key:0},ct={key:1},Ye=K({__name:"preview",props:{modelValue:{type:Boolean,default:!1},url:{type:String,default:""},type:{type:String,default:"image"}},emits:["update:modelValue"],setup(e,{emit:r}){const b=e,m=re(),h=Y({get(){return b.modelValue},set(d){r("update:modelValue",d)}}),y=()=>{r("update:modelValue",!1)},u=w([]);return X(()=>b.modelValue,d=>{d?ge(()=>{var v;u.value=[b.url],(v=m.value)==null||v.play()}):ge(()=>{var v;u.value=[],(v=m.value)==null||v.pause()})}),(d,v)=>{const p=ml,c=se("video-player"),F=Pe;return V((o(),f("div",null,[e.type=="image"?(o(),f("div",rt,[l(u).length?(o(),$(p,{key:0,"url-list":l(u),"hide-on-click-modal":"",onClose:y},null,8,["url-list"])):A("",!0)])):A("",!0),e.type=="video"?(o(),f("div",ct,[t(F,{modelValue:l(h),"onUpdate:modelValue":v[0]||(v[0]=R=>j(h)?h.value=R:null),width:"740px",title:"\u89C6\u9891\u9884\u89C8","before-close":y},{default:n(()=>[t(c,{ref_key:"playerRef",ref:m,src:e.url,width:"100%",height:"450px"},null,8,["src"])]),_:1},8,["modelValue"])])):A("",!0)],512)),[[ue,e.modelValue]])}}}),me=e=>(We("data-v-49f20224"),e=e(),Ge(),e),mt={class:"material"},pt={class:"material__left"},ft={class:"flex-1 min-h-0"},vt={class:"material-left__content pt-4 p-b-4"},_t={class:"flex flex-1 items-center min-w-0 pr-4"},ht=me(()=>s("img",{class:"w-[20px] h-[16px] mr-3",src:Ol},null,-1)),gt={class:"flex-1 truncate mr-2"},yt=me(()=>s("span",{class:"muted m-r-10"},"\xB7\xB7\xB7",-1)),bt=["onClick"],Ct={class:"flex justify-center p-2 border-t border-br"},wt={class:"material__center flex flex-col"},kt={class:"operate-btn flex"},Et={class:"flex-1 flex"},Ft=me(()=>s("span",{class:"mr-5"},"\u79FB\u52A8\u6587\u4EF6\u81F3",-1)),At={class:"flex items-center ml-2"},St={key:0,class:"mt-3"},$t={class:"material-center__content flex flex-col flex-1 mb-1 min-h-0"},Vt={class:"file-list flex flex-wrap mt-4"},Dt={key:0,class:"item-selected"},Bt={class:"operation-btns flex items-center"},zt={class:"inline-block"},Rt={class:"inline-block"},xt={class:"inline-block"},Ut={key:1,class:"flex flex-1 justify-center items-center"},Pt={class:"material-center__footer flex justify-between items-center mt-2"},It={class:"flex"},Lt={class:"mr-3"},Tt=me(()=>s("span",{class:"mr-5"},"\u79FB\u52A8\u6587\u4EF6\u81F3",-1)),Mt={key:0,class:"material__right"},jt={class:"flex justify-between p-2 flex-wrap"},Nt={class:"sm flex items-center"},Wt={key:0},Gt={class:"flex-1 min-h-0"},qt={class:"select-lists flex flex-col p-t-3"},Yt={class:"select-item"},Kt=K({__name:"index",props:{fileSize:{type:String,default:"100px"},limit:{type:Number,default:1},type:{type:String,default:"image"},mode:{type:String,default:"picker"},pageSize:{type:Number,default:15}},emits:["change"],setup(e,{expose:r,emit:b}){const m=e,{limit:h}=je(m),y=Y(()=>{switch(m.type){case"image":return 10;case"video":return 20;case"file":return 30;default:return 0}}),u=pl("visible"),d=w(""),v=w(!1),{treeRef:p,cateId:c,cateLists:F,handleAddCate:R,handleEditCate:M,handleDeleteCate:_,getCateLists:D,handleCatSelect:g}=at(y.value),{tableRef:Z,listShowType:x,moveId:P,pager:S,fileParams:O,select:I,isCheckAll:L,isIndeterminate:i,getFileList:C,refresh:N,batchFileDelete:te,batchFileMove:Ce,selectFile:pe,isSelect:we,clearSelect:ke,cancelSelete:Oe,selectAll:Ee,handleFileRename:Fe}=ot(c,y,h,m.pageSize),Ae=async()=>{var T;await D(),(T=p.value)==null||T.setCurrentKey(c.value),C()},fe=T=>{d.value=T,v.value=!0};return X(u,async T=>{T&&Ae()},{immediate:!0}),X(c,()=>{O.name="",N()}),X(I,T=>{if(b("change",T),T.length==S.lists.length&&T.length!==0){i.value=!1,L.value=!0;return}T.length>0?i.value=!0:(L.value=!1,i.value=!1)},{deep:!0}),fl(()=>{m.mode=="page"&&Ae()}),r({clearSelect:ke}),(T,k)=>{const Se=xl,$e=wl,ne=Zl,Qe=kl,Xe=El,Je=vl,ve=Ne,B=Me,Ve=Gl,De=Ie,Be=Le,ze=ye,ae=ce,He=Te,Re=Fl,_e=Al,xe=qe,J=_l,el=hl,ll=gl,tl=Bl,U=yl("perms"),nl=bl;return V((o(),f("div",mt,[s("div",pt,[s("div",ft,[t(ve,null,{default:n(()=>[s("div",vt,[t(Je,{ref_key:"treeRef",ref:p,"node-key":"id",data:l(F),"empty-text":"''","highlight-current":!0,"expand-on-click-node":!1,"current-node-key":l(c),onNodeClick:l(g)},{default:n(({data:a})=>[s("div",_t,[ht,s("span",gt,[t(Se,{content:a.name},null,8,["content"])]),a.id>0?V((o(),$(Xe,{key:0,"hide-on-click":!1},{dropdown:n(()=>[t(Qe,null,{default:n(()=>[V((o(),$(ne,{onConfirm:z=>l(M)(z,a.id),size:"default",value:a.name,width:"400px",limit:20,"show-limit":"",teleported:""},{default:n(()=>[s("div",null,[t($e,null,{default:n(()=>[E(" \u547D\u540D\u5206\u7EC4 ")]),_:1})])]),_:2},1032,["onConfirm","value"])),[[U,["common:album:cateRename"]]]),V((o(),f("div",{onClick:z=>l(_)(a.id)},[t($e,null,{default:n(()=>[E("\u5220\u9664\u5206\u7EC4")]),_:1})],8,bt)),[[U,["common:album:cateDel"]]])]),_:2},1024)]),default:n(()=>[yt]),_:2},1024)),[[U,["common:album:cateRename","common:album:cateDel"]]]):A("",!0)])]),_:1},8,["data","current-node-key","onNodeClick"])])]),_:1})]),s("div",Ct,[V((o(),$(ne,{onConfirm:l(R),size:"default",width:"400px",limit:20,"show-limit":"",teleported:""},{default:n(()=>[t(B,null,{default:n(()=>[E(" \u6DFB\u52A0\u5206\u7EC4 ")]),_:1})]),_:1},8,["onConfirm"])),[[U,["common:album:cateAdd"]]])])]),s("div",wt,[s("div",kt,[s("div",Et,[e.type=="image"?V((o(),$(Ve,{key:0,class:"mr-3",data:{cid:l(c)},type:e.type,"show-progress":!0,onChange:l(N)},{default:n(()=>[t(B,{type:"primary"},{default:n(()=>[E("\u672C\u5730\u4E0A\u4F20")]),_:1})]),_:1},8,["data","type","onChange"])),[[U,["common:upload:image"]]]):A("",!0),e.type=="video"?V((o(),$(Ve,{key:1,class:"mr-3",data:{cid:l(c)},type:e.type,"show-progress":!0,onChange:l(N)},{default:n(()=>[t(B,{type:"primary"},{default:n(()=>[E("\u672C\u5730\u4E0A\u4F20")]),_:1})]),_:1},8,["data","type","onChange"])),[[U,["common:upload:video"]]]):A("",!0),e.mode=="page"?V((o(),$(B,{key:2,disabled:!l(I).length,onClick:k[0]||(k[0]=G(a=>l(te)(),["stop"]))},{default:n(()=>[E(" \u5220\u9664 ")]),_:1},8,["disabled"])),[[U,["common:album:albumDel"]]]):A("",!0),e.mode=="page"?V((o(),$(ze,{key:3,class:"ml-3",onConfirm:l(Ce),disabled:!l(I).length,title:"\u79FB\u52A8\u6587\u4EF6"},{trigger:n(()=>[t(B,{disabled:!l(I).length},{default:n(()=>[E("\u79FB\u52A8")]),_:1},8,["disabled"])]),default:n(()=>[s("div",null,[Ft,t(Be,{modelValue:l(P),"onUpdate:modelValue":k[1]||(k[1]=a=>j(P)?P.value=a:null),placeholder:"\u8BF7\u9009\u62E9"},{default:n(()=>[(o(!0),f(W,null,Q(l(F),a=>(o(),f(W,{key:a.id},[a.id!==""?(o(),$(De,{key:0,label:a.name,value:a.id},null,8,["label","value"])):A("",!0)],64))),128))]),_:1},8,["modelValue"])])]),_:1},8,["onConfirm","disabled"])),[[U,["common:album:albumMove"]]]):A("",!0)]),t(He,{class:"w-60",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",modelValue:l(O).name,"onUpdate:modelValue":k[2]||(k[2]=a=>l(O).name=a),onKeyup:Cl(l(N),["enter"])},{append:n(()=>[t(B,{onClick:l(N)},{icon:n(()=>[t(ae,{name:"el-icon-Search"})]),_:1},8,["onClick"])]),_:1},8,["modelValue","onKeyup"]),s("div",At,[t(Re,{content:"\u5217\u8868\u89C6\u56FE",placement:"top"},{default:n(()=>[s("div",{class:de(["list-icon",{select:l(x)=="table"}]),onClick:k[3]||(k[3]=a=>x.value="table")},[t(ae,{name:"local-icon-list-2",size:18})],2)]),_:1}),t(Re,{content:"\u5E73\u94FA\u89C6\u56FE",placement:"top"},{default:n(()=>[s("div",{class:de(["list-icon",{select:l(x)=="normal"}]),onClick:k[4]||(k[4]=a=>x.value="normal")},[t(ae,{name:"el-icon-Menu",size:18})],2)]),_:1})])]),e.mode=="page"?(o(),f("div",St,[t(_e,{disabled:!l(S).lists.length,modelValue:l(L),"onUpdate:modelValue":k[5]||(k[5]=a=>j(L)?L.value=a:null),onChange:l(Ee),indeterminate:l(i)},{default:n(()=>[E(" \u5F53\u9875\u5168\u9009 ")]),_:1},8,["disabled","modelValue","onChange","indeterminate"])])):A("",!0),s("div",$t,[l(S).lists.length?V((o(),$(ve,{key:0},{default:n(()=>[s("ul",Vt,[(o(!0),f(W,null,Q(l(S).lists,a=>(o(),f("li",{class:"file-item-wrap",key:a.id,style:be({width:e.fileSize})},[t(xe,{onClose:z=>l(te)([a.id])},{default:n(()=>[t(ie,{uri:a.uri,"file-size":e.fileSize,type:e.type,onClick:z=>l(pe)(a)},{default:n(()=>[l(we)(a.id)?(o(),f("div",Dt,[t(ae,{size:24,name:"el-icon-Check",color:"#fff"})])):A("",!0)]),_:2},1032,["uri","file-size","type","onClick"])]),_:2},1032,["onClose"]),t(Se,{class:"mt-1",content:a.name},null,8,["content"]),s("div",Bt,[V((o(),$(ne,{onConfirm:z=>l(Fe)(z,a.id),size:"default",value:a.name,width:"400px",limit:50,"show-limit":"",teleported:""},{default:n(()=>[t(B,{type:"primary",link:""},{default:n(()=>[E(" \u91CD\u547D\u540D ")]),_:1})]),_:2},1032,["onConfirm","value"])),[[U,["common:album:albumRename"]]]),t(B,{type:"primary",link:"",onClick:z=>fe(a.uri)},{default:n(()=>[E(" \u67E5\u770B ")]),_:2},1032,["onClick"])])],4))),128))])]),_:1},512)),[[ue,l(x)=="normal"]]):A("",!0),V(t(ll,{ref_key:"tableRef",ref:Z,class:"mt-4",data:l(S).lists,width:"100%",height:"100%",size:"large",onRowClick:l(pe)},{default:n(()=>[t(J,{width:"55"},{default:n(({row:a})=>[t(_e,{modelValue:l(we)(a.id),onChange:z=>l(pe)(a)},null,8,["modelValue","onChange"])]),_:1}),t(J,{label:"\u56FE\u7247",width:"100"},{default:n(({row:a})=>[t(ie,{uri:a.uri,"file-size":"50px",type:e.type},null,8,["uri","type"])]),_:1}),t(J,{label:"\u540D\u79F0","min-width":"100","show-overflow-tooltip":""},{default:n(({row:a})=>[t(el,{onClick:G(z=>fe(a.uri),["stop"]),underline:!1},{default:n(()=>[E(oe(a.name),1)]),_:2},1032,["onClick"])]),_:1}),t(J,{prop:"createTime",label:"\u4E0A\u4F20\u65F6\u95F4","min-width":"100"}),t(J,{label:"\u64CD\u4F5C",width:"150",fixed:"right"},{default:n(({row:a})=>[V((o(),f("div",zt,[t(ne,{onConfirm:z=>l(Fe)(z,a.id),size:"default",value:a.name,width:"400px",limit:50,"show-limit":"",teleported:""},{default:n(()=>[t(B,{type:"primary",link:""},{default:n(()=>[E(" \u91CD\u547D\u540D ")]),_:1})]),_:2},1032,["onConfirm","value"])])),[[U,["common:album:albumRename"]]]),s("div",Rt,[t(B,{type:"primary",link:"",onClick:G(z=>fe(a.uri),["stop"])},{default:n(()=>[E(" \u67E5\u770B ")]),_:2},1032,["onClick"])]),V((o(),f("div",xt,[t(B,{type:"primary",link:"",onClick:G(z=>l(te)([a.id]),["stop"])},{default:n(()=>[E(" \u5220\u9664 ")]),_:2},1032,["onClick"])])),[[U,["common:album:albumDel"]]])]),_:1})]),_:1},8,["data","onRowClick"]),[[ue,l(x)=="table"]]),!l(S).loading&&!l(S).lists.length?(o(),f("div",Ut," \u6682\u65E0\u6570\u636E~ ")):A("",!0)]),s("div",Pt,[s("div",It,[e.mode=="page"?(o(),f(W,{key:0},[s("span",Lt,[t(_e,{disabled:!l(S).lists.length,modelValue:l(L),"onUpdate:modelValue":k[6]||(k[6]=a=>j(L)?L.value=a:null),onChange:l(Ee),indeterminate:l(i)},{default:n(()=>[E(" \u5F53\u9875\u5168\u9009 ")]),_:1},8,["disabled","modelValue","onChange","indeterminate"])]),V((o(),$(B,{disabled:!l(I).length,onClick:k[7]||(k[7]=a=>l(te)())},{default:n(()=>[E(" \u5220\u9664 ")]),_:1},8,["disabled"])),[[U,["common:album:albumDel"]]]),V((o(),$(ze,{class:"ml-3 inline",onConfirm:l(Ce),disabled:!l(I).length,title:"\u79FB\u52A8\u6587\u4EF6"},{trigger:n(()=>[t(B,{disabled:!l(I).length},{default:n(()=>[E("\u79FB\u52A8")]),_:1},8,["disabled"])]),default:n(()=>[s("div",null,[Tt,t(Be,{modelValue:l(P),"onUpdate:modelValue":k[8]||(k[8]=a=>j(P)?P.value=a:null),placeholder:"\u8BF7\u9009\u62E9"},{default:n(()=>[(o(!0),f(W,null,Q(l(F),a=>(o(),f(W,{key:a.id},[a.id!==""?(o(),$(De,{key:0,label:a.name,value:a.id},null,8,["label","value"])):A("",!0)],64))),128))]),_:1},8,["modelValue"])])]),_:1},8,["onConfirm","disabled"])),[[U,["common:album:albumMove"]]])],64)):A("",!0)]),t(tl,{modelValue:l(S),"onUpdate:modelValue":k[9]||(k[9]=a=>j(S)?S.value=a:null),onChange:l(C),layout:"total, prev, pager, next, jumper"},null,8,["modelValue","onChange"])])]),e.mode=="picker"?(o(),f("div",Mt,[s("div",jt,[s("div",Nt,[E(" \u5DF2\u9009\u62E9 "+oe(l(I).length)+" ",1),l(h)?(o(),f("span",Wt,"/"+oe(l(h)),1)):A("",!0)]),t(B,{type:"primary",link:"",onClick:l(ke)},{default:n(()=>[E("\u6E05\u7A7A")]),_:1},8,["onClick"])]),s("div",Gt,[t(ve,{class:"ls-scrollbar"},{default:n(()=>[s("ul",qt,[(o(!0),f(W,null,Q(l(I),a=>(o(),f("li",{class:"mb-4",key:a.id},[s("div",Yt,[t(xe,{onClose:z=>l(Oe)(a.id)},{default:n(()=>[t(ie,{uri:a.uri,"file-size":"100px",type:e.type},null,8,["uri","type"])]),_:2},1032,["onClose"])])]))),128))])]),_:1})])])):A("",!0),t(Ye,{modelValue:l(v),"onUpdate:modelValue":k[10]||(k[10]=a=>j(v)?v.value=a:null),url:l(d),type:e.type},null,8,["modelValue","url","type"])])),[[nl,l(S).loading]])}}});const Ke=le(Kt,[["__scopeId","data-v-49f20224"]]),Zt=K({components:{Popup:ye,Draggable:Sl,FileItem:ie,Material:Ke,Preview:Ye},props:{modelValue:{type:[String,Array],default:()=>[]},type:{type:String,default:"image"},size:{type:String,default:"100px"},fileSize:{type:String,default:"100px"},limit:{type:Number,default:1},disabled:{type:Boolean,default:!1},hiddenUpload:{type:Boolean,default:!1},uploadClass:{type:String,default:""},excludeDomain:{type:Boolean,default:!1}},emits:["change","update:modelValue"],setup(e,{emit:r}){const b=w(),m=w(),h=w(""),y=w(!1),u=w([]),d=w([]),v=w(!0),p=w(-1),{disabled:c,limit:F,modelValue:R}=je(e),{getImageUrl:M}=Ul(),_=Y(()=>{switch(e.type){case"image":return"\u56FE\u7247";case"video":return"\u89C6\u9891";default:return""}}),D=Y(()=>e.limit-u.value.length>0),g=Y(()=>v.value?F.value==-1?null:F.value-u.value.length:1),Z=$l(()=>{const i=d.value.map(C=>e.excludeDomain?C.path:C.uri);v.value?u.value=[...u.value,...i]:u.value.splice(p.value,1,i.shift()),S()},1e3,!1),x=i=>{var C;c.value||(i>=0?(v.value=!1,p.value=i):v.value=!0,(C=b.value)==null||C.open())},P=i=>{d.value=i},S=()=>{const i=F.value!=1?u.value:u.value[0]||"";r("update:modelValue",i),r("change",i),L()},O=i=>{u.value.splice(i,1),S()},I=i=>{h.value=i,y.value=!0},L=()=>{ge(()=>{var i;e.hiddenUpload&&(u.value=[]),(i=m.value)==null||i.clearSelect()})};return X(R,i=>{u.value=Array.isArray(i)?i:i==""?[]:[i]},{immediate:!0}),Ue("limit",e.limit),Ue("hiddenUpload",e.hiddenUpload),{popupRef:b,materialRef:m,fileList:u,tipsText:_,handleConfirm:Z,meterialLimit:g,showUpload:D,showPopup:x,selectChange:P,deleteImg:O,previewUrl:h,showPreview:y,handlePreview:I,handleClose:L,getImageUrl:M}}});const Ze=e=>(We("data-v-d1489be1"),e=e(),Ge(),e),Ot={class:"material-select"},Qt=["onClick"],Xt={class:"operation-btns text-xs text-center"},Jt=Ze(()=>s("span",null,"\u4FEE\u6539",-1)),Ht=["onClick"],en=Ze(()=>s("span",null,"\u6DFB\u52A0",-1)),ln={class:"material-wrap"};function tn(e,r,b,m,h,y){const u=se("file-item"),d=qe,v=se("draggable"),p=ce,c=Ke,F=Ne,R=ye,M=se("preview");return o(),f("div",Ot,[t(R,{ref:"popupRef",width:"830px","custom-class":"body-padding",title:`\u9009\u62E9${e.tipsText}`,onConfirm:e.handleConfirm,onClose:e.handleClose},Vl({default:n(()=>[t(F,null,{default:n(()=>[s("div",ln,[t(c,{ref:"materialRef",type:e.type,"file-size":e.fileSize,limit:e.meterialLimit,onChange:e.selectChange},null,8,["type","file-size","limit","onChange"])])]),_:1})]),_:2},[e.hiddenUpload?void 0:{name:"trigger",fn:n(()=>[s("div",{class:"material-select__trigger clearfix",onClick:r[2]||(r[2]=G(()=>{},["stop"]))},[t(v,{class:"draggable",modelValue:e.fileList,"onUpdate:modelValue":r[0]||(r[0]=_=>e.fileList=_),animation:"300","item-key":"id"},{item:n(({element:_,index:D})=>[s("div",{class:de(["material-preview",{"is-disabled":e.disabled,"is-one":e.limit==1}]),onClick:g=>e.showPopup(D)},[t(d,{onClose:g=>e.deleteImg(D)},{default:n(()=>[t(u,{uri:e.excludeDomain?e.getImageUrl(_):_,"file-size":e.size,type:e.type},null,8,["uri","file-size","type"])]),_:2},1032,["onClose"]),s("div",Xt,[Jt,E(" | "),s("span",{onClick:G(g=>e.handlePreview(_),["stop"])},"\u67E5\u770B",8,Ht)])],10,Qt)]),_:1},8,["modelValue"]),V(s("div",{class:de(["material-upload",{"is-disabled":e.disabled,"is-one":e.limit==1,[e.uploadClass]:!0}]),onClick:r[1]||(r[1]=_=>e.showPopup(-1))},[ee(e.$slots,"upload",{},()=>[s("div",{class:"upload-btn",style:be({width:e.size,height:e.size})},[t(p,{size:25,name:"el-icon-Plus"}),en],4)],!0)],2),[[ue,e.showUpload]])])]),key:"0"}]),1032,["title","onConfirm","onClose"]),t(M,{modelValue:e.showPreview,"onUpdate:modelValue":r[3]||(r[3]=_=>e.showPreview=_),url:e.previewUrl,type:e.type},null,8,["modelValue","url","type"])])}const un=le(Zt,[["render",tn],["__scopeId","data-v-d1489be1"]]);export{un as _};
