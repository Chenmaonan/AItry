import{_ as U}from"./index.222c373c.js";import{e as x,q as F,aW as c,an as I,a3 as k,aY as S,b0 as q,aX as M,aZ as R,b1 as N,ab as z,o as T,g as Z,h as o,w as t,u as a,j as i,Z as j}from"./.pnpm.adeb4fcc.js";import{a as W,g as X,f as w,s as Y,b as G}from"./index.32787260.js";const H={class:"user-setting"},J={class:"w-80"},K={class:"w-80"},L={class:"w-80"},O={class:"w-80"},Q={class:"w-80"},$=x({__name:"profile",setup(ee){const m=F(),_=F(),p=W(),f=c({}),B="//backend/avatar/upload";I(()=>{f.Authorization="Bearer "+X()});const e=c({avatar:"",account:"",name:"",currentPassword:"",newPassword:"",confirmPassword:""}),E=c({avatar:[{required:!0,message:"\u5934\u50CF\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}],account:[{required:!0,message:"\u8BF7\u8F93\u5165\u767B\u5F55\u8D26\u53F7",trigger:["blur"]}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0",trigger:["blur"]}],currentPassword:[{validator:(s,u,r)=>{e.newPassword&&(u||r(new Error("\u8BF7\u8F93\u5165\u5F53\u524D\u5BC6\u7801"))),r()},trigger:"blur"}],newPassword:[{validator:(s,u,r)=>{e.currentPassword&&(u||r(new Error("\u8BF7\u8F93\u5165\u65B0\u7684\u5BC6\u7801"))),r()},trigger:"blur"}],confirmPassword:[{validator:(s,u,r)=>{e.newPassword&&(u||r(new Error("\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801")),u!==e.newPassword&&r(new Error("\u4E24\u6B21\u8F93\u5165\u5BC6\u7801\u4E0D\u4E00\u81F4!"))),r()},trigger:"blur"}]}),g=s=>{if(s.code!==200){w.msgError(s.msg);return}e.avatar=s.data.url},v=async()=>{const s=p.userInfo;for(const u in e)e[u]=s[u]},C=async()=>{await Y(e),w.msgSuccess("\u4FDD\u5B58\u6210\u529F"),await p.getUserInfo()},b=()=>{m.value.submit()},P=async()=>{var s;await((s=_.value)==null?void 0:s.validate()),await C()};return v(),(s,u)=>{const r=k,n=S,A=q,d=M,V=R,h=N,D=z,y=U;return T(),Z("div",H,[o(h,{class:"!border-none",shadow:"never"},{default:t(()=>[o(V,{ref_key:"formRef",ref:_,class:"ls-form",model:a(e),rules:a(E),"label-width":"100px"},{default:t(()=>[o(A,{ref_key:"uploadRef",ref:m,name:"avatar",action:B,headers:a(f),"on-success":g,"show-file-list":!1,"auto-upload":!0,limit:1},{default:t(()=>[o(n,{label:"\u7528\u6237\u5934\u50CF\uFF1A",prop:"avatar"},{default:t(()=>[o(r,{size:80,src:a(e).avatar,onClick:b},null,8,["src"])]),_:1})]),_:1},8,["headers"]),o(n,{label:"\u767B\u5F55\u8D26\u53F7\uFF1A",prop:"account"},{default:t(()=>[i("div",J,[o(d,{modelValue:a(e).account,"onUpdate:modelValue":u[0]||(u[0]=l=>a(e).account=l)},null,8,["modelValue"])])]),_:1}),o(n,{label:"\u7528\u6237\u6635\u79F0\uFF1A",prop:"name"},{default:t(()=>[i("div",K,[o(d,{modelValue:a(e).name,"onUpdate:modelValue":u[1]||(u[1]=l=>a(e).name=l),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0"},null,8,["modelValue"])])]),_:1}),o(n,{label:"\u5F53\u524D\u5BC6\u7801\uFF1A",prop:"currentPassword"},{default:t(()=>[i("div",L,[o(d,{modelValue:a(e).currentPassword,"onUpdate:modelValue":u[2]||(u[2]=l=>a(e).currentPassword=l),modelModifiers:{trim:!0},placeholder:"\u4FEE\u6539\u5BC6\u7801\u65F6\u5FC5\u586B, \u4E0D\u4FEE\u6539\u5BC6\u7801\u65F6\u7559\u7A7A",type:"password","show-password":""},null,8,["modelValue"])])]),_:1}),o(n,{label:"\u65B0\u7684\u5BC6\u7801\uFF1A",prop:"newPassword"},{default:t(()=>[i("div",O,[o(d,{modelValue:a(e).newPassword,"onUpdate:modelValue":u[3]||(u[3]=l=>a(e).newPassword=l),modelModifiers:{trim:!0},placeholder:"\u4FEE\u6539\u5BC6\u7801\u65F6\u5FC5\u586B, \u4E0D\u4FEE\u6539\u5BC6\u7801\u65F6\u7559\u7A7A",type:"password","show-password":""},null,8,["modelValue"])])]),_:1}),o(n,{label:"\u786E\u8BA4\u5BC6\u7801\uFF1A",prop:"confirmPassword"},{default:t(()=>[i("div",Q,[o(d,{modelValue:a(e).confirmPassword,"onUpdate:modelValue":u[4]||(u[4]=l=>a(e).confirmPassword=l),modelModifiers:{trim:!0},placeholder:"\u4FEE\u6539\u5BC6\u7801\u65F6\u5FC5\u586B, \u4E0D\u4FEE\u6539\u5BC6\u7801\u65F6\u7559\u7A7A",type:"password","show-password":""},null,8,["modelValue"])])]),_:1})]),_:1},8,["model","rules"])]),_:1}),o(y,null,{default:t(()=>[o(D,{type:"primary",onClick:P},{default:t(()=>[j("\u4FDD\u5B58")]),_:1})]),_:1})])}}});const se=G($,[["__scopeId","data-v-c340fb42"]]);export{se as default};
